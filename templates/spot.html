{% extends 'base.html' %}

{% block content %}

<div class="container">
        <div class="row">
            <div class="col s12">
                <!-- messages for user rate or comment interactions -->
                {% with spot = get_flashed_messages(category_filter=['spot']) %}
                    {% if spot %}
                        {% for message in spot %}                            
                            <h5>{{ message }}</h5>
                        {% endfor %}
                    {% endif %}
                {% endwith %}
            </div>
        </div>
    </div>

<div class="container">
    <div class="row">
        <div class="col s12">
            <div class="col s12 m6">
                <h4>{{ location.name | title }}</h4>
                <h5>{{ location.country | title }} | {{ location.region | title }}</h5>
                <h6>Details:</h6>
                <ul>
                    <li>Break Type: {{ location.break_type }}</li>
                    <li>Wave Direction: {{ location.wave_direction }}</li>
                    <li>Wind Direction: {{ location.wind_direction }}</li>
                    <li>Swell Direction: {{ location.swell_direction }}</li>
                    <li>Bottom: {{ location.bottom }}</li>
                    <li>Surroundings: {{ location.surroundings }}</li>
                </ul>
            </div>

            <div class="col s12 m6">
                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT9mc03R0DpiqAoT63-c7Ap5A8cl1b5f7UKKxhCI62alUOwuHWB">
            </div>
        </div>

        <div class="col s12">
            <div class="col s12 m6">
                <ul>
                    <li>
                        <ul>Facilities:
                            {% for value in location.facilities %}
                            <li>- {{ value }}</li>
                            {% endfor %}
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="col s12 m6">
                <ul>
                    <li>
                        <ul>Hazards:
                            {% for value in location.hazards %}
                            <li>- {{ value }}</li>
                            {% endfor %}
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

        <div class="col s12">
            <h6>Description:</h6>
            <p>{{ location.description }}</p>
            <h6>Rating:</h6>
            {% for rate in location.ratings %}
                {% if rate.rate is defined and rate.rate != None %}
                    <p>{{ rate.rate }} by {{ rate.user_name }}</p>
                {% else %}
                    <p>Not yet rated</p>
                {% endif %}
            {% endfor %}
            <h6>Comments:</h6>
            {% for comment in location.comments | sort(reverse=True, attribute='date_added') %}
            <p>> {{ comment.user_name }} on <i>{{ comment.date_added }}</i></p>
            <p>'{{ comment.comment }}'</p>
            <p class="divider"></p>
            {% endfor %}
        </div>
 
    </div>
</div>

<!-- messages for user login interactions -->

<div class="container">
    <div class="row">
        <div class="col s12">
            {% with login = get_flashed_messages(category_filter=['login']) %}
                {% if login %}
                    {% for message in login %}                            
                        <h5>{{ message }}</h5>
                    {% endfor %}
                {% endif %}
            {% endwith %}
        </div>
    </div>
</div>

<div class="container">
 
        <div class="col s12 m4 center-align">
                <a href="{{ url_for('user_input', location_id=location._id) }}" class="waves-effect btn-flat" id="explore">Rate and Comment</a>
        </div


        <div class="col s12 m4 center-align">
            <a href="{{ url_for('locations') }}" class="waves-effect btn-flat" id="explore">EXPLORE ALL</a>
        </div>
</div>

<div class="container">
    <h4 class="center-align">Check some other locations on our list:</h4>
    <div class="row">
        {% for location in locations_random %}
        <a href="{{ url_for('spot', location_id=location.old_id[0]) }}">
            <div class="col s12 l4">
                <div class="card">
                    <div class="card-image">
                        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT9mc03R0DpiqAoT63-c7Ap5A8cl1b5f7UKKxhCI62alUOwuHWB">
                        <span class="card-title">{{ location._id | title }}</span>
                        <div class="btn-floating halfway-fab transparent center-align">
                            <i class="material-icons">star</i>                            
                        </div>
                        <div class="btn-floating halfway-fab transparent center-align">
                            {% if location.average_rating == None %}
                                <p class="rating-floating">{{0}}</p>
                            {% else %}
                                <p class="rating-floating">{{ location.average_rating | round|int }}</p>
                            {% endif %}
                        </div>
                    </div>
                    <div class="card-content center-align light-blue white-text">
                        <p>{{ location.country_name[0] | title }} | {{ location.break_type_name[0] }}</p>
                    </div>
                    <div class="card-action center-align">
                        <h6>Explore</h6>
                    </div>
                </div>
            </div>
        </a>
        {% endfor %}
    </div>
</div>
{% endblock %}